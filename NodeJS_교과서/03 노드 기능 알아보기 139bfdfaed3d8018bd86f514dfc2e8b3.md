# 03. ë…¸ë“œ ê¸°ëŠ¥ ì•Œì•„ë³´ê¸°
## 3.1 REPL ì‚¬ìš©í•˜ê¸°

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì–¸ì–´ì´ë¯€ë¡œ ì»´íŒŒì¼ ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ë¸Œë¼ìš°ì € ì½˜ì†”ì°½ ë§ê³  ë…¸ë“œì—ì„œ ì œê³µí•˜ëŠ” ì½˜ì†”ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```bash
$ node
>

# .exitì„ í•˜ë©´ ì¢…ë£Œí•  ìˆ˜ ìˆìŒ
```

ì½”ë“œë¥¼ ì½ê³ (React), í•´ì„í•˜ê³ (Eval), ê²°ê³¼ë¬¼ì„ ë°˜í™˜í•˜ê³ (Print), ì¢…ë£Œí•  ë•Œê¹Œì§€ ë°˜ë³µ(Loop)í•œë‹¤.

â‡’ REPL

## 3.2 JS íŒŒì¼ ì‹¤í–‰í•˜ê¸°

ì´ë²ˆì—” íŒŒì¼ì„ ì´ìš©í•´ì„œ ì‹¤í–‰í•´ë³¸ë‹¤.

```bash
$ node [filePath]
```

## 3.3 ëª¨ë“ˆ ë§Œë“¤ê¸°

ëª¨ë“ˆì´ë€?

- íŠ¹ì •í•œ ê¸°ëŠ¥ì„ í•˜ëŠ” í•¨ã…ìˆ˜ë‚˜ ë³€ìˆ˜ë“¤ì˜ ì§‘í•©

ë…¸ë“œì—ì„œ ëª¨ë“ˆì€ ë‘ ê°€ì§€ í˜•ì‹ì´ ì¡´ì¬í•œë‹¤.

- CommonJS Module
- ECMASCript Module

### CommonJS Module

í‘œì¤€ì´ ë‚˜ì˜¤ê¸° ì „ë¶€í„° ì‚¬ìš©í•´ì„œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” ëª¨ë“ˆ

var.js

```jsx
const a = 10
const b = 20

module.exports = {
	a,
	b
}

// ìœ„ì™€ ë™ì¼í•œ ë°©ì‹ì„
// exports.a = a
// exports.b = b
// module.exportsì™€ modulesëŠ” ë™ì¼í•œ ê°ì²´ë¥¼ ì°¸ì¡°í•˜ê¸° ë•Œë¬¸
// ë‘˜ì€ ì°¸ì¡° ê´€ê³„ê°€ ê¹¨ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ê°™ì´ ì•ˆ ì“°ëŠ” ê²ƒì´ ì¢‹ìŒ
```

func.js

```jsx
const sumResult = (a, b) => {
	console.log(`${a} + ${b} = ${a + b}`)
}

module.exports = sumResult
```

index.js

```jsx
const { a, b } = require('./var')
const sumResult = require('./func')
```

### nodeì˜ this

```jsx
console.log(this) // {}
console.log(this === module.exports) // true
console.log(this === exports); // true

(function() {
	console.log(this === exports) // false
	console.log(this === global) // true
})()
```

ìµœìƒìœ„ ìŠ¤ì½”í”„ thisëŠ” `module.exports(exports)` ê°ì²´ë¥¼ ê°€ë¦¬í‚¤ë©° í•¨ìˆ˜ ì„ ì–¸ë¬¸ ë‚´ë¶€ thisëŠ” `global`ì„ ê°€ë¦¬í‚¨ë‹¤.

### require

require í•¨ìˆ˜ì— ëŒ€í•´ ì•Œì•„ë³¸ë‹¤.

<aside>
â„¹ï¸

ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ í•¨ìˆ˜ëŠ” ê°ì²´ì´ë‹¤. require ê°ì²´ì˜ í”„ë¡œí¼í‹°ë¥¼ ëª‡ëª‡ ì•Œì•„ë³¸ë‹¤.

</aside>

```jsx

```

ì£¼ì˜ ì‚¬í•­

dep1.js

```jsx
const dep2 = require('./dep2')
console.log('require dep2', dep2)
module.expors = () => {
	console.log('dep2', dep2)
}
```

dep2.js

```jsx
const dep1 = require('./dep1')
console.log('require dep1', dep1)
module.expors = () => {
	console.log('dep1', dep1K)
}
```

index.js

```jsx
const dep1 = require('./dep1')
const dep2 = require('./dep2')

dep1()
dep2()
```

dep2 [Function (anonymous)]
dep1 {}
(node:63506) Warning: Accessing non-existent property 'Symbol(nodejs.util.inspect.custom)' of module exports inside circular dependency
(Use `node --trace-warnings ...` to show where the warning was created)
(node:63506) Warning: Accessing non-existent property 'constructor' of module exports inside circular dependency
(node:63506) Warning: Accessing non-existent property 'Symbol(Symbol.toStringTag)' of module exports inside circular dependency

dep1ì˜ module.exportsê°€ í•¨ìˆ˜ê°€ ì•„ë‹Œ ë¹ˆ ê°ì²´ë¡œ í‘œì‹œë˜ëŠ” ê²ƒì„ ìˆœí™˜ ì°¸ì¡°ë¼ê³  í•œë‹¤.

ìˆœí™˜ ì°¸ì¡°ê°€ ìˆì„ ê²½ìš° ìˆœí™˜ ì°¸ì¡° ëŒ€ìƒì„ ë¹ˆ ê°ì²´ë¡œ ë°”ê¾¸ê³  ê²½ê³ ë¥¼ ì¼ìœ¼í‚¨ë‹¤.

### ECMAScript Module

- ê³µì‹ì ì¸ ìë°”ìŠ¤í¬ë¦½íŠ¸ ëª¨ë“ˆ í˜•ì‹ìœ¼ë¡œ ë¸Œë¼ìš°ì €ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

require â†’ import

exports â†’ export

module.exports â†’ export default

ECMAScript ëª¨ë“ˆì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” `.mjs`ë¡œ í™•ì¥ìë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ë©° `.js`ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ package.jsonì—ì„œ `type: â€œmoduleâ€` ì†ì„±ì„ ë„£ìœ¼ë©´ ëœë‹¤.

### __filename, __dirname

```jsx
console.log(__filename) // í˜„ì¬ íŒŒì¼ëª…
console.log(__dirname) // í˜„ì¬ íŒŒì¼ ê²½ë¡œ
```

ES ëª¨ë“ˆì—ì„œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë©° import.meta.urlë¡œ ê²½ë¡œë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

```jsx
console.log(import.meta.url)
```

## 3. 4 ë…¸ë“œ ë‚´ì¥ ê°ì²´ ì•Œì•„ë³´ê¸°

ë¸Œë¼ìš°ì €ì˜ window ê°ì²´ì™€ ìœ ì‚¬í•˜ê²Œ Nodeì—ì„œ ë”°ë¡œ ë‚´ì¥ ê°ì²´ë¥¼ ì œê³µí•œë‹¤.

ë…¸ë“œ í”„ë¡œê·¸ë˜ë°ì—ì„œ ë§ì´ ì‚¬ìš©ë˜ëŠ” ë‚´ì¥ ê°ì²´ì— ëŒ€í•´ ì•Œì•„ë³´ì.

### global

> ì „ì—­ ê°ì²´
â‡’ ëª¨ë“  íŒŒì¼ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆìŒ
> 

[`window.open](http://window.open) â‡’ open` ì´ë ‡ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë“¯ì´ `global`ì„ ìƒëµí•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

`require` í•¨ìˆ˜ë„ ë§ˆì°¬ê°€ì§€ë¡œ `global.require` ì´ë ‡ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ê±°ì„.

<aside>
â„¹ï¸

ë…¸ë“œì—ëŠ” DOMê³¼ BOMì´ ì—†ê¸° ë•Œë¬¸ì— windowë‚˜ document ê°ì²´ë¥¼ ë…¸ë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

ë”°ë¼ì„œ, ì´ ë‘˜ì„ ì•„ìš°ë¥´ëŠ” globalThis ê°ì²´ê°€ ë§Œë“¤ì–´ì¡Œìœ¼ë©° ë¸Œë¼ìš°ì €ì—ì„œëŠ” windowë¡œ ë…¸ë“œì—ì„œëŠ” globalë¡œ ëœë‹¤.

</aside>

ì „ì—­ ê°ì²´ì´ê¸° ë•Œë¬¸ì— ê°„ë‹¨í•œ ë°ì´í„°ë¥¼ ê³µìœ í•  ë•Œ ì‚¬ìš©í•˜ê¸°ë„ í•¨

a.js

```jsx
module.exports = () => glbal.message
```

b.js

```jsx
const A = require('./a')

global.message = 'hello'

console.log(A()) // hello
```

í•˜ì§€ë§Œ, ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›Œì ¸ `global` ê°ì²´ë¥¼ ë‚¨ìš©í•˜ëŠ” ê²ƒì€ ì¢‹ì§€ ì•Šë‹¤.

### console

ë°‘ì˜ ë©”ì„œë“œë“¤ ê°„ë‹¨íˆ ì‚´í´ë³´ë©´ ì¢‹ë‹¤

- log
- time, timeEnd
- error
- table
- dir
- trace

### íƒ€ì´ë¨¸

- setTimeout
- setInterval
- setImmediate

â‡’ ìœ„ì˜ í•¨ìˆ˜ë“¤ì€ idë¥¼ ë°˜í™˜í•˜ëŠ”ë°

- clearTimeout
- clearInterval
- clearImmediate

â‡’ ìœ„ í•¨ìˆ˜ë¥¼ í†µí•´ ì·¨ì†Œí•  ìˆ˜ ìˆë‹¤.

íƒ€ì´ë¨¸ë¥¼ í”„ë¡œë¯¸ìŠ¤ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ë„ ìˆëŠ”ë° ì´ëŠ” ë‚´ì¥ ê°ì²´ê°€ ì•„ë‹Œ ë‚´ì¥ ëª¨ë“ˆì´ë‹¤.

```jsx
import { setTimeout } from 'timer/promises'

await setTimeout(3000)
console.log('3ì´ˆ ë’¤ ì‹¤í–‰')
```

## 3.5 ë…¸ë“œ ë‚´ì¥ ëª¨ë“ˆ ì‚¬ìš©í•˜ê¸°

ë…¸ë“œëŠ” ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ìš©ë˜ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ë³´ë‹¤ ë” ë§ì€ ê¸°ëŠ¥ë“¤ì„ ì œê³µí•œë‹¤.

- ìš´ì˜ì²´ì œ ì ‘ê·¼
- í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ ì£¼ì†Œ
- etc

ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ ì¤‘ ì¤‘ìš”í•œ ëª‡ê°€ì§€ì— ëŒ€í•´ ì•Œì•„ë³¸ë‹¤.

### os

```jsx
const os = require('os')

const printMethod = (list) => {
  for (const method of list) {
    console.log(`os.${method} : ${os[method]}`)
  }
}

console.log('ìš´ì˜ì²´ì œ ì •ë³´')
printMethod(['arch', 'platform', 'type', 'uptime', 'hostname', 'release'])

console.log('ê²½ë¡œ')
printMethod(['homedir', 'tempdir'])

console.log('cpu ì •ë³´')
printMethod(['cpus'])

console.log('ë©”ëª¨ë¦¬ ì •ë³´')
printMethod(['freemem', 'totalmem'])
```

```jsx
ìš´ì˜ì²´ì œ ì •ë³´
os.arch : arm64 // ì•„í‚¤í…ì²˜ ì •ë³´ (process.archì™€ ë™ì¼)
os.platform : darwin // í”Œë«í¼ ì •ë³´ (process.platformê³¼ ë™ì¼)
os.type : Darwin // ìš´ì˜ì²´ì œ ì •ë³´
os.uptime : 1351487 // ë¶€íŒ… í›„ íë¥¸ ì‹œê°„ (ì´ˆ) / (process.uptimeì€ nodeì˜ ì‹¤í–‰ ì‹œê°„)
os.hostname : tengui-MacBookAir.local // ì»´í“¨í„°ì˜ ì´ë¦„
os.release : 24.0.0 // ìš´ì˜ì²´ì œ ë²„ì „
ê²½ë¡œ 
os.homedir : /Users/teng // í™ˆ ë””ë ‰í† ë¦¬ ê²½ë¡œ
os.tempdir : /var/folders/yk/px23h3t50fn50y19rbdwp81r0000gn/T // ì„ì‹œ íŒŒì¼ ì €ì¥ ê²½ë¡œ
cpu ì •ë³´
// ì»´í“¨í„° ì½”ì–´ ì •ë³´
[
  {
    model: 'Apple M1',
    speed: 2400,
    times: {
      user: 130112060,
      nice: 0,
      sys: 104499610,
      idle: 411272250,
      irq: 0
    }
  },
  {
    model: 'Apple M1',
    speed: 2400,
    times: {
      user: 123665770,
      nice: 0,
      sys: 96852340,
      idle: 425854040,
      irq: 0
    }
  },
  {
    model: 'Apple M1',
    speed: 2400,
    times: {
      user: 110993400,
      nice: 0,
      sys: 85193050,
      idle: 450975980,
      irq: 0
    }
  },
  {
    model: 'Apple M1',
    speed: 2400,
    times: {
      user: 103592020,
      nice: 0,
      sys: 77255080,
      idle: 466905420,
      irq: 0
    }
  },
  {
    model: 'Apple M1',
    speed: 2400,
    times: { user: 77763760, nice: 0, sys: 62668660, idle: 508372370, irq: 0 }
  },
  {
    model: 'Apple M1',
    speed: 2400,
    times: { user: 55906100, nice: 0, sys: 40941820, idle: 552520490, irq: 0 }
  },
  {
    model: 'Apple M1',
    speed: 2400,
    times: { user: 38153790, nice: 0, sys: 27835390, idle: 583821820, irq: 0 }
  },
  {
    model: 'Apple M1',
    speed: 2400,
    times: { user: 30141110, nice: 0, sys: 23450930, idle: 596477870, irq: 0 }
  }
]
ë©”ëª¨ë¦¬ ì •ë³´
os.freemem : 63766528 // ì‚¬ìš© ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬
os.totalmem : 8589934592 // ì „ì²´ ë©”ëª¨ë¦¬ ìš©ëŸ‰
```

### path

```jsx
const path = require('path')
const filename = __filename

// ê²½ë¡œ êµ¬ë¶„ì ìœˆë„ìš° -> '\' POISX -> '/'
console.log(`path.sep: ${path.sep}`)
// path.sep: /

// í™˜ê²½ ë³€ìˆ˜ì˜ êµ¬ë¶„ì
// process.env.PATHë¥¼ í•˜ë©´ ì—¬ëŸ¬ ê°œì˜ ê²½ë¡œê°€ êµ¬ë¶„ìë¡œ ë˜ì–´ìˆëŠ”ë°
// ìœˆë„ìš° -> ';', POSIX -> ':'
console.log(`path.delimiter: ${path.delimiter}`)
// path.delimiter: :

console.log('\n')
// íŒŒì¼ì´ ìœ„ì¹˜í•œ ê²½ë¡œë¥¼ ë³´ì—¬ì¤Œ
console.log(`path.dirname(): ${path.dirname(filename)}`)
// path.dirname(): /Users/teng/archive/NodeJS_êµê³¼ì„œ/example/inner_module

// íŒŒì¼ì˜ í™•ì¥ìë¥¼ ë³´ì—¬ì¤Œ
console.log(`path.extname(): ${path.extname(filename)}`)
// path.extname(): .js

// íŒŒì¼ì˜ ì´ë¦„(í™•ì¥ì í¬í•¨)ì„ í‘œì‹œí•¨ ê·¸ë¦¬ê³  í™•ì¥ìë¥¼ ë¹¼ê³  ì‹¶ë‹¤ë©´ ë‘ ë²ˆì§¸ ì¸ìˆ˜ë¡œ í™•ì¥ìë¥¼ ë„£ìœ¼ë©´ ë¨
console.log(`path.basename(): ${path.basename(filename)}`)
// path.basename(): path.js
console.log(`path.basename - extname: ${path.basename(filename, path.extname(filename))}`)
// path.basename - extname: path

console.log('\n')
// íŒŒì¼ ê²½ë¡œë¥¼ root, dir, base, ext, nameìœ¼ë¡œ íŒŒì‹±í•¨
console.log(path.parse(filename))
/* 
{
  root: '/',
  dir: '/Users/teng/archive/NodeJS_êµê³¼ì„œ/example/inner_module',
  base: 'path.js',
  ext: '.js',
  name: 'path'
}
*/

// path.parseí•œ ê°ì²´ë¥¼ íŒŒì¼ ê²½ë¡œë¡œ í•©ì¹¨
console.log(`path.format(): ${path.format({
  root: '/',
  dir: '/Users/teng/archive/NodeJS_êµê³¼ì„œ/example/inner_module',
  base: 'path2.js',
  ext: '.js',
  name: 'path2'
})}`)
// path.format(): /Users/teng/archive/NodeJS_êµê³¼ì„œ/example/inner_module/path2.js

// /ë‚˜ \ë¥¼  ì‹¤ìˆ˜ë¡œ ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í–ˆê±°ë‚˜ í˜¼ìš©í–ˆì„ ë•Œ ì •ìƒì ì¸ ê²½ë¡œë¡œ ë°˜í™˜
console.log(`path.normalize(): ${path.normalize('//////////path.js')}`)
// path.normalize(): /path.js

console.log('\n')

// íŒŒì¼ì˜ ê²½ë¡œê°€ ìƒëŒ€ ê²½ë¡œì¸ì§€ ì ˆëŒ€ ê²½ë¡œì¸ì§€ íŒë‹¨í•´ì¤Œ
console.log(`path.isAbsolute(/Users): ${path.isAbsolute('/Users')}`) // true
console.log(`path.isAbsolute(./home): ${path.isAbsolute('./home')}`) // false

console.log('\n')

// path.relative(ê¸°ì¤€ê²½ë¡œ, ë¹„êµê²½ë¡œ) ê¸°ì¤€ê²½ë¡œì—ì„œ ë¹„êµê²½ë¡œë¡œ ê°€ëŠ” ë°©ë²•ì„ ì•Œë ¤ì¤Œ
console.log(`path.relative(): ${path.relative(`${path.dirname(filename)}/os.js`, `${path.dirname(filename)}/path.js`)}`)
// path.relative(): ../path.js

// path.join(ê²½ë¡œ, ...) ì—¬ëŸ¬ ì¸ìˆ˜ë¥¼ ë„£ìœ¼ë©´ í•˜ë‚˜ì˜ ê²½ë¡œë¡œ í•©ì¹œë‹¤
// . -> í˜„ì¬ | .. -> ë¶€ëª¨
console.log(`path.join(): ${path.join(__dirname, '..', '..', '/users', '.', '/')}`)
// path.join(): /Users/teng/archive/NodeJS_êµê³¼ì„œ/users/

// path.resolve(ê²½ë¡œ, ...) joinê³¼ ë™ì¼í•˜ì§€ë§Œ /ë¥¼ ë§Œë‚˜ë©´ ì ˆëŒ€ ê²½ë¡œë¡œ ì¸ì‹í•´ì„œ ì•ì˜ ê²½ë¡œë¥¼ ë¬´ì‹œí•¨
console.log(`path.resolve(): ${path.resolve(__dirname, '..', 'users', '.', '/')}`)
// /
```

ë§Œì•½, ìœˆë„ìš°ì—ì„œ POSIXë¥¼ ì“°ê±°ë‚˜ ê·¸ ë°˜ëŒ€ì¼ ê²½ìš° `path.posix.sep`, `path.posix.join()`ê³¼ `path.win32.sep`, `path.win32.join()`

### url

ì¸í„°ë„· ì£¼ì†Œë¥¼ ì‰½ê²Œ ì¡°ì‘í•˜ë„ë¡ ë•ëŠ” ëª¨ë“ˆ

- WHATWG ğŸ‘
- node ë°©ì‹

ë¸Œë¼ìš°ì €ì—ì„œ WHATWGë¥¼ ì‚¬ìš©í•´ì„œ í˜¸í™˜ì„±ì´ ì¢‹ìŒ

```jsx
const url = require('url')

const { URL } = url // ë…¸ë“œì—ì„œë„ ì œê³µí•´ì„œ ìƒëµ ê°€ëŠ¥

const myURL = new URL('http://www.gilbut.co.kr/book/bookList.aspx?sercate1=01001000#anchor')
console.log('new URL', myURL)
/*
new URL URL {
  href: 'http://www.gilbut.co.kr/book/bookList.aspx?sercate1=01001000#anchor',
  origin: 'http://www.gilbut.co.kr',
  protocol: 'http:',
  username: '',
  password: '',
  host: 'www.gilbut.co.kr',
  hostname: 'www.gilbut.co.kr',
  port: '',
  pathname: '/book/bookList.aspx',
  search: '?sercate1=01001000',
  searchParams: URLSearchParams { 'sercate1' => '01001000' },
  hash: '#anchor'
}
*/

// ë¶„í•´ë˜ì—ˆë˜ url ê°ì²´ë¥¼ ë‹¤ì‹œ ì¡°ë¦½
console.log('url.format()', url.format(myURL))
// url.format() http://www.gilbut.co.kr/book/bookList.aspx?sercate1=01001000#anchor
```

node ë‚´ì¥ ê°ì²´ URLSearchParamsì— ëŒ€í•´ ì•Œì•„ë³´ì

```jsx
const url = new URL('http://naver.com/?page=3&page=4&limit=10')
const searchParams = url.searchParams

console.log(searchParams)
// URLSearchParams { 'page' => '3', 'page' => '4', 'limit' => '10' }

console.log('getAll', searchParams.getAll('page')) // ['3', '4']

console.log('get', searchParams.get('page')) // 3
console.log('get', searchParams.get('limit')) // 10

console.log('has', searchParams.has('page')) // true
console.log('has', searchParams.has('a')) // false

console.log(searchParams.keys()) // Iterator { 'page', 'page', 'limit' }
console.log(searchParams.values()) // Iterator { '3', '4', '10' }

searchParams.append('filter', 'node')
console.log(searchParams.get('filter')) // node

searchParams.set('filter', 'a')
console.log(searchParams.getAll('filter')) // [ 'a' ]

searchParams.delete('filter')
console.log(searchParams.has('filter')) // false

console.log(searchParams.toString()) // page=3&page=4&limit=10

```

### dns

DNSë¥¼ ë‹¤ë£° ë•Œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“ˆë¡œ ë„ë©”ì¸ì„ í†µí•´ IPë‚˜ ê¸°íƒ€ DNS ì •ë³´ë¥¼ ì–»ê³ ì í•  ë•Œ ì‚¬ìš©

```jsx
import dns from 'dns/promises'

// IPë¥¼ ì–»ëŠ” ë°©ë²•
const ip = await dns.lookup('gilbut.co.kr')
console.log('IP', ip)
const a = await dns.resolve('gilbut.co.kr', 'A')
console.log('A', a)

const mx = await dns.resolve('gilbut.co.kr', 'MX')
console.log('MX', mx)
const cname = await dns.resolve('www.gilbut.co.kr', 'CNAME')
console.log('CNAME', cname)
const any = await dns.resolve('gilbut.co.kr', 'ANY')
console.log('ANY', any)

// resolve í•¨ìˆ˜ì— ë‘ë²ˆì§¸ ì¸ìë¥¼ í†µí•´ ë ˆì½”ë“œë¡œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
// - A IPv4
// - AAAA IPv6
// - NS name server
// - SOA ë„ë©”ì¸ ì •ë³´
// - CNAME ë³„ì¹­
// - MX ë©”ì¼ ì„œë²„
```

```jsx
IP { address: '49.236.151.220', family: 4 }
A [ '49.236.151.220' ]
MX [
  { exchange: 'aspmx.l.google.com', priority: 1 },
  { exchange: 'aspmx3.googlemail.com', priority: 10 },
  { exchange: 'alt1.aspmx.l.google.com', priority: 5 },
  { exchange: 'alt2.aspmx.l.google.com', priority: 5 },
  { exchange: 'aspmx2.googlemail.com', priority: 10 }
]
CNAME [ 'slb-1088813.ncloudslb.com' ]
ANY [
  { value: 'ns1-2.ns-ncloud.com', type: 'NS' },
  { value: 'ns1-1.ns-ncloud.com', type: 'NS' },
  {
    nsname: 'ns1-1.ns-ncloud.com',
    hostmaster: 'ns1-2.ns-ncloud.com',
    serial: 132,
    refresh: 21600,
    retry: 1800,
    expire: 1209600,
    minttl: 300,
    type: 'SOA'
  }
]
```

### crypto

ë‹¤ì–‘í•œ ë°©ì‹ì˜ ì•”í˜¸í™”ë¥¼ ë•ëŠ” ëª¨ë“ˆ

<aside>
ğŸ¤”

ë§Œì•½ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•´ì•¼ í•œë‹¤ë©´, ê·¸ëƒ¥ ë¹„ë°€ë²ˆí˜¸ ìì²´ë¥¼ ë„£ìœ¼ë©´ ì•ˆ ëœë‹¤.

ë”°ë¼ì„œ, ì•”í˜¸í™”ë¥¼ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.

</aside>

ì•”í˜¸í™” ë°©ì‹ì—ëŠ” í¬ê²Œ ë‘ ê°€ì§€ê°€ ìˆë‹¤.

- ë‹¨ë°©í–¥ ì•”í˜¸í™”
    - ë³µí˜¸í™”í•  ìˆ˜ ì—†ëŠ” ì•”í˜¸í™” ë°©ì‹
- ì–‘ë°©í–¥ ì•”í˜¸í™”
    - ë³µí˜¸í™”í•  ìˆ˜ ìˆëŠ” ì•”í˜¸í™” ë°©ì‹
    - ëŒ€ì¹­

### ë‹¨ë°©í–¥ ì•”í˜¸í™”

ë¹„ë°€ë²ˆí˜¸ì™€ ê°™ì´ ì›ë˜ ë¬¸ìì—´ì„ ì•Œ í•„ìš”ì—†ëŠ” ê²½ìš°ì—ëŠ” ë‹¨ë°©í–¥ ì•”í˜¸í™”ë¥¼ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.

ì´ëŸ¬í•œ ì•”í˜¸í™”ë¥¼ `í•´ì‹œ í•¨ìˆ˜`ë¼ê³  ë¶€ë¥´ê¸°ë„ í•œë‹¤.

â†’ ë¡œê·¸ì¸ ì‹œì—ëŠ” ë°›ì€ ë°ì´í„°ë¥¼ ì•”í˜¸í™”í•´ì„œ ì•”í˜¸í™”ëœ ë¬¸ìì—´ê³¼ ë¹„êµí•˜ë©´ ëœë‹¤.

hash.js

```jsx
const crypto = require('crypto')

console.log('base64: ', crypto.createHash('sha512').update('ë¹„ë°€ë²ˆí˜¸').digest('base64'))
// base64:  dvfV6nyLRRt3NxKSlTHOkkEGgqW2HRtfu19Ou/psUXvwlebbXCboxIPmDYOFRIpqav2eUTBFuHaZri5x+usy1g==
```

createHash

- ì‚¬ìš©í•  í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ì„ ë„£ëŠ”ë‹¤ sha512ë§Œ í•´ë„ ì¶©ë¶„í•˜ë‹¤. í•„ìš”í•˜ë‹¤ë©´ ë” ê°•í•œ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ë°”ê¾¸ë©´ ëœë‹¤.

update

- ë³€í™˜í•  ë¬¸ìì—´ (ì—¬ê¸°ì„œëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ëœë‹¤.)

digest

- ì¸ì½”ë”© ì•Œê³ ë¦¬ì¦˜ì„ ë„£ëŠ”ë‹¤.
- base64ê°€ ì§§ì•„ì„œ ë§ì´ ì‚¬ìš©ëœë‹¤.

ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ ê°„ë‹¨í•˜ê²Œ ë” ì•Œì•„ë³´ì.

ë…¸ë“œì—ì„œëŠ” pbkdf2, bcrypt, scrypt ë“± ì•Œê³ ë¦¬ì¦˜ì´ ì¡´ì¬í•œë‹¤.

pbkdf2ì— ëŒ€í•´ ê°„ë‹¨íˆ ì•Œì•„ë³´ì.

pbkdf2

- ê¸°ì¡´ ë¬¸ìì—´ì— saltë¥¼ ë¶™ì´ê³  í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ì„ ë°˜ë³µí•´ì„œ ì ìš©í•˜ëŠ” ê²ƒ

```jsx
const crypto = require('crypto')

crypto.randomBytes(64, (err, buf) => {
  const salt = buf.toString('base64')
  console.log('salt', salt)

  crypto.pbkdf2('ë¹„ë°€ë²ˆí˜¸', salt, 100000, 64, 'sha512', (err, key) => {
    console.log('password', key.toString('base64'))
  })
})
```

pbkdf2

- ì²«ë²ˆì§¸ ì¸ì
    - ì•”í˜¸í™”í•  ë¬¸ìì—´
- ë‘ë²ˆì§¸ ì¸ì
    - salt
    - randomìœ¼ë¡œ ë‚˜ì˜¤ê¸° ë•Œë¬¸ì— ì•”í˜¸í™”í•˜ê³  saltë¥¼ ì˜ ë³´ê´€í•˜ê³  ìˆì–´ì•¼ í•¨
- ì„¸ë²ˆì§¸ ì¸ì
    - ë°˜ë³µ íšŸìˆ˜ 10ë§Œë²ˆ ë°˜ë³µí•˜ëŠ”ê±´ë° ì–´ì§œí”¼ ì»´í“¨í„°ë¡œëŠ” 1ì´ˆì •ë„ë°–ì— ì•ˆ ê±¸ë¦¼
    - ì¶”ê°€ì ìœ¼ë¡œ ë‚´ë¶€ì ìœ¼ë¡œ ìŠ¤ë ˆë“œ í’€ì„ ì‚¬ìš©í•´ ë©€í‹° ìŠ¤ë ˆë”©ìœ¼ë¡œ ë™ì‘í•¨ (ë¸”ë¡œí‚¹ X)
- ë„¤ë²ˆì§¸ ì¸ì
    - 64byteì˜ ë¬¸ìì—´
- ë‹¤ì„¯ë²ˆì§¸ ì¸ì
    - ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ (hash function)
- ì—¬ì„¯ë²ˆì§¸ ì¸ì
    - callback function

### ì–‘ë°©í–¥ ì•”í˜¸í™”

ì–‘ë°©í–¥ ëŒ€ì¹­í˜• ì•”í˜¸í™” â†’ ì•”í˜¸í™”ëœ ë¬¸ìì—´ì„ ë³µí˜¸í™”í•  ìˆ˜ ìˆìœ¼ë©°, `í‚¤`ê°€ ì‚¬ìš©ë¨.

### ë” ë‚˜ì•„ê°€

- crypto ëª¨ë“ˆì— ëŒ€í•´ ê³µì‹ë¬¸ì„œë¥¼ ì‚´í´ë³´ëŠ” ê²ƒì´ ì¢‹ë‹¤
- npm crypto-js ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆìœ¼ë‹ˆ í™•ì¸í•´ë³´ë©´ ì¢‹ë‹¤.

### utils

ê°ì¢… í¸ì˜ ê¸°ëŠ¥ì„ ëª¨ì•„ë‘” ëª¨ë“ˆ

ê³„ì† APIê°€ ìƒê¸°ê³  ìˆê³ , `deprecated`ë˜ëŠ” ê²½ìš°ë„ ìˆë‹¤.

```jsx
const util = require('util');

const dontUseFunc = util.deprecate((x, y) => {
  console.log(x + y)
}, 'dontUseFunc í•¨ìˆ˜ëŠ” deprecatedë˜ì—ˆìœ¼ë‹ˆ ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”!')
dontUseFunc(1, 2)
// 3
// (node:50503) DeprecationWarning: dontUseFunc í•¨ìˆ˜ëŠ” deprecatedë˜ì—ˆìœ¼ë‹ˆ ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”!
// (Use `node --trace-deprecation ...` to show where the warning was created)

const callbackFunc = (x, y, callback) => {
  try {
    const result = x + y // ê³„ì‚° ìˆ˜í–‰
    callback(null, result) // ì²« ë²ˆì§¸ ì¸ìëŠ” ì—ëŸ¬(null), ë‘ ë²ˆì§¸ëŠ” ê²°ê³¼
  } catch (error) {
    callback(error) // ì—ëŸ¬ ë°œìƒ ì‹œ ì—ëŸ¬ë¥¼ ì „ë‹¬
  }
}

const promiseFunc = util.promisify(callbackFunc)

;(async () => {
  try {
    const result = await promiseFunc(1, 2);
    console.log(result) // 3
  } catch (error) {
    console.error(error);
  }
})()
```

### worker_threads

ë…¸ë“œì—ì„œ ë©€í‹° ìŠ¤ë ˆë“œ ë°©ì‹ìœ¼ë¡œ ì‘ì—…í•  ìˆ˜ ìˆë‹¤.

`thread`

```jsx
const {
  Worker,
  isMainThread,
  parentPort
} = require('worker_threads')

if (isMainThread) { // ë©”ì¸ ìŠ¤ë ˆë“œì¼ ë•Œ
  const worker = new Worker(__filename)
  worker.on('message', message => console.log('from worker', message))
  worker.on('exit', () => console.log('worker exit'))
  worker.postMessage('ping')
} else { // ì›Œì»¤ì¼ ë•Œ
  parentPort.on('message', (value) => {
    console.log('from parent', value)
    parentPort.postMessage('pong')
    parentPort.close()
  })
}
```

`workerData`

```jsx
const {
  Worker,
  isMainThread,
  parentPort,
  workerData
} = require('worker_threads')

if (isMainThread) { // main thread
  const threads = new Set() // Set ìë£Œêµ¬ì¡°ë¥¼ í†µí•´ì„œ threadë¥¼ ê´€ë¦¬
  for (let i = 0; i < 3; ++i) {
    threads.add(new Worker(__filename, {
      workerData: { start: i }
    }))
  }

  for (const worker of threads) {
    worker.on('message', message => console.log(message))
    worker.on('exit', () => {
      threads.delete(worker)
      
      if (threads.size === 0) {
        console.log('job done')
      }
    })
  }
} else { // worker
  const data = workerData // workerì˜ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  parentPort.postMessage(data.start + 100)
  // ì¢…ë£Œë˜ë©´ main threadì˜ worker.on('exit', callback)ì´ ì‹¤í–‰
}
```

ì†Œìˆ˜ êµ¬í•˜ê¸°

```jsx
const min = 2
const max = 10000000
const primes = []

function findPrimes(start, end) {
  let isPrime = true
  for (let i = start; i <= end; ++i) {
    for (let j = min; j < Math.sqrt(end); ++j) {
      if (i !== j && i % j === 0) {
        isPrime = false
        break
      }
    }

    if (isPrime) {
      primes.push(i)
    }
    isPrime = true
  }
}

console.time('prime')
findPrimes(min, max)
console.timeEnd('prime') // prime: 5.229s
console.log(primes.length) // 664579
```

ì´ëŸ¬í•œ ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦¬ëŠ” ì‘ì—…ì„ ì›Œì»¤ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•´ ë¬¸ì œë¥¼ ë‚˜ëˆ ì„œ í‘¼ë‹¤.

```jsx
// prime: 953.716ms
// 664579
const {
  Worker, 
  isMainThread,
  parentPort,
  workerData
} = require('worker_threads')

const min = 2
let primes = []

function findPrimes(start, end) {
  let isPrime = true
  for (let i = start; i <= end; ++i) {
    for (let j = min; j < Math.sqrt(end); ++j) {
      if (i !== j && i % j === 0) {
        isPrime = false
        break
      }
    }

    if (isPrime) {
      primes.push(i)
    }
    isPrime = true
  }
}

if (isMainThread) {
  const max = 10000000
  const threadCount = 8
  const threads = new Set()
  const range = Math.floor((max - min) / threadCount)

  let start = min
  console.time('prime')
  for (let i = 0; i < threadCount - 1; ++i) {
    const end = start + range - 1
    threads.add(new Worker(__filename, {
      workerData: { start, range: end }
    }))
    start += range
  }
  threads.add(new Worker(__filename, {
    workerData: { start, range: max }
  }))

  for (const worker of threads) {
    worker.on('error', (err) => {
      throw err
    })

    worker.on('exit', () => {
      threads.delete(worker)
      if (threads.size === 0) {
        console.timeEnd('prime')
        console.log(primes.length)
      }
    })

    worker.on('message', (message) => {
      primes = primes.concat(message)
    })
  }
} else {
  findPrimes(workerData.start, workerData.range)
  parentPort.postMessage(primes)
}
```

### child_process

ë…¸ë“œì—ì„œ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ê³  ì‹¶ê±°ë‚˜ ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“ˆ

ì´ ëª¨ë“ˆì„ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ ì–¸ì–´ì˜ ì½”ë“œ (python, â€¦)ë¥¼ ì‹¤í–‰í•˜ê³  ê²°ê´ê°’ì„ ë°›ì„ ìˆ˜ ìˆìŒ.

í˜„ì¬ ë…¸ë“œ í”„ë¡œì„¸ìŠ¤ ì™¸ì˜ ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ë¥¼ ë„ì›Œì„œ ëª…ë ¹ì„ ìˆ˜í–‰í•˜ê³  ë…¸ë“œ í”„ë¡œì„¸ìŠ¤ì— ê²°ê³¼ë¥¼ ì•Œë ¤ì£¼ê¸° ë•Œë¬¸ì— child_processë¼ëŠ” ì´ë¦„ì„ ë¶™ì˜€ë‹¤.

```
const exec = require('child_process').exec
const process = exec('ls')

process.stdout.on('data', (data) => {
  console.log(data.toString())
  // ls ëª…ë ¹ì–´ë¥¼ ì…ë ¥í–ˆì„ ë•Œì˜ ê²°ê³¼ê°’ì„ ì¶œë ¥í•œë‹¤.
})

process.stderr.on('data', (data) => {
  console.error(data.toString())
})
```

```jsx
const spawn = require('child_process').spawn
const process = spawn('python', [`${__dirname}/hello.py`])

process.stdout.on('data', (data) => {
  console.log(data.toString())
})

process.stderr.on('data', (data) => {
  console.log(data.toString())
})
```

### ê¸°íƒ€ ëª¨ë“ˆ

> ê´€ë ¨í•´ì„œ ì§ì ‘ ì˜ˆì œ ì½”ë“œ ë§Œë“¤ì–´ë³´ë©´ì„œ ê³µë¶€í•´ë³´ë©´ ì¢‹ì„ê±° ê°™ìŒ
> 

- async_hooks
    - ë¹„ë™ê¸° ì½”ë“œì˜ íë¦„ì„ ì¶”ì í•  ìˆ˜ ìˆëŠ” ì‹¤í—˜ì ì¸ ëª¨ë“ˆ
- dgram
    - UDPì™€ ê´€ë ¨ëœ ì‘ì—…ì„ í•  ë•Œ ì‚¬ìš©
- net
    - HTTPë³´ë‹¤ ë¡œìš° ë ˆë²¨ì¸ TCP / IPC í†µì‹ í•  ë•Œ ì‚¬ìš©
- perf_hooks
    - ì„±ëŠ¥ ì¸¡ì •ì„ í•  ë•Œ console.timeë³´ë‹¤ ë” ì •êµí•˜ê²Œ ì¸¡ì •
- querystring
    - URLSearchParamsê°€ ë‚˜ì˜¤ê¸° ì´ì „ì— ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì„ ë‹¤ë£¨ê¸° ìœ„í•´ ì‚¬ìš©í–ˆë˜ ëª¨ë“ˆ
- string_decoder
    - ë²„í¼ ë°ì´í„°ë¥¼ ë¬¸ìì—´ë¡œ ë°”ê¾¸ëŠ” ë° ì‚¬ìš©
- tls
    - TLS / SSLì— ê´€ë ¨ëœ ì‘ì—…ì„ í•  ë•Œ ì‚¬ìš©
- tty
    - í„°ë¯¸ë„ê³¼ ê´€ë ¨ëœ ì‘ì—…ì„ í•  ë•Œ ì‚¬ìš©
- v8
    - v8 ì—”ì§„ì— ì§ì ‘ ì ‘ê·¼í•  ë•Œ ì‚¬ìš©
- vm
    - ê°€ìƒ ë¨¸ì‹ ì— ì§ì ‘ ì ‘ê·¼í•  ë•Œ ì‚¬ìš©
- wasi
    - ì›¹ì–´ì…ˆë¸”ë¦¬ë¥¼ ì‹¤í–‰í•  ë•Œ ì‚¬ìš©

## ëŠë‚€ì 

- NodeJSë¥¼ í†µí•´ ë§ì€ ê²ƒë“¤ì„ í•  ìˆ˜ ìˆëŠ” ê²ƒì„ ëŠê¼ˆê³ , ì¬ë°Œê²Œ ì½ì—ˆë‹¤.
- ì•”í˜¸í•™ì€ ëì´ ì—†ì„ê±° ê°™ì•„ì„œ ê°„ë‹¨íˆ ì‚´í´ë´¤ë‹¤.
- Nodeì—ì„œ ì œê³µí•˜ëŠ” ë‹¤ì–‘í•œ APIì— ëŒ€í•´ì„œëŠ” ë‚˜ì¤‘ì— ì²œì²œíˆ ê³µì‹ë¬¸ì„œ ì½ì–´ë³´ë©´ ì¢‹ì„ê±° ê°™ë‹¤.
- ES moduleì´ë‘ CommonJS moduleëŠ” ë”¥ë‹¤ì´ë¸Œì—ì„œ ì†Œê°œí•´ì„œ ê°„ë‹¨í•˜ê²Œ ì•Œê³  ìˆì—ˆëŠ”ë° ì¢€ ë” ê¹Šê²Œ ì•Œê²Œ ëœ ê³„ê¸°ê°€ ë˜ì—ˆë‹¤.
- threadì™€ processì˜ ì°¨ì´ì ì— ë” ì•Œê²Œ ëë‹¤.
- aiëŠ” pythonìœ¼ë¡œ ê°œë°œí•˜ê³ , spawn ì¨ì„œ nodeë¡œ ai ëª¨ë¸ ì„œë¹™í•˜ëŠ” ê²ƒë„ ê°œë°œí•  ìˆ˜ ìˆì„ê±° ê°™ë‹¤.
    - GPT ë§ë¡œëŠ” ë§ì´ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´ì´ë¼ê³  í•œë‹¤.